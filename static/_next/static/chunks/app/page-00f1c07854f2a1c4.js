(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3897:function(e,t,s){Promise.resolve().then(s.bind(s,2551))},2551:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return G}});var a=s(7437),n=s(2265),l=s(7086);let r={idle:{icon:"●",color:"text-green-400"},thinking:{icon:"◐",color:"text-orange-400"},typing:{icon:"⌨",color:"text-blue-400"},sending:{icon:"↑",color:"text-purple-400"},sleeping:{icon:"\uD83D\uDCA4",color:"text-gray-400"}};function i(e){let{agents:t,selectedId:s,onSelect:n,onCreate:l,onDelete:i}=e;return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-gray-800 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold p-4 border-b border-gray-700",children:"Agents"}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-2",children:0===t.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No agents yet"}):t.map(e=>{let t=r[e.status]||r.idle,l=s===e.id;return(0,a.jsx)("button",{onClick:()=>n(e),className:"w-full text-left p-3 rounded-lg mb-1 transition-colors ".concat(l?"bg-blue-600/30 border border-blue-500/50":"hover:bg-gray-700/50"),children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"".concat(t.color," ").concat("thinking"===e.status?"status-thinking":""),children:t.icon}),(0,a.jsxs)("span",{className:"flex-1 truncate",children:[e.name||"Unnamed",(0,a.jsxs)("span",{className:"text-gray-500 text-sm",children:[" (#",e.id,")"]})]})]})},e.id)})}),(0,a.jsxs)("div",{className:"p-2 border-t border-gray-700 flex gap-2",children:[(0,a.jsx)("button",{onClick:l,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-colors",children:"+ New"}),(0,a.jsx)("button",{onClick:()=>s&&i(s),disabled:!s,className:"flex-1 bg-gray-600 hover:bg-gray-500 disabled:opacity-50 disabled:cursor-not-allowed text-white py-2 px-4 rounded-lg transition-colors",children:"Delete"})]})]})}let c={idle:{text:"● Idle",color:"text-green-400"},thinking:{text:"◐ Waiting...",color:"text-orange-400"},typing:{text:"⌨ Typing...",color:"text-blue-400"},sending:{text:"↑ Sending...",color:"text-purple-400"},sleeping:{text:"\uD83D\uDCA4 Sleeping",color:"text-gray-400"}};function o(e){let{agent:t,models:s,onSave:l,expanded:r,onToggle:i}=e,[o,d]=(0,n.useState)({});(0,n.useEffect)(()=>{t&&d({name:t.name,model:t.model,background_prompt:t.background_prompt,temperature:t.temperature,room_wpm:t.room_wpm,heartbeat_interval:t.heartbeat_interval,can_create_agents:t.can_create_agents})},[t]);let x=t&&c[t.status]||c.idle;return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg flex flex-col ".concat(r?"h-full":""),children:[(0,a.jsxs)("button",{onClick:i,className:"w-full text-left p-3 flex items-center gap-2 hover:bg-gray-700/50 transition-colors flex-shrink-0 ".concat(r?"rounded-t-lg":"rounded-lg"),children:[(0,a.jsx)("span",{className:"text-gray-400",children:r?"▼":"▶"}),(0,a.jsx)("span",{className:"font-semibold",children:"Agent Settings"}),t&&(0,a.jsx)("span",{className:"ml-auto ".concat(x.color),children:x.text})]}),r&&(0,a.jsx)("div",{className:"p-4 pt-2 flex-1 flex flex-col min-h-0 overflow-auto",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex gap-3 mb-3 flex-wrap",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[150px]",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Name"}),(0,a.jsx)("input",{type:"text",value:o.name||"",onChange:e=>d({...o,name:e.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded px-2 py-1.5 text-sm focus:outline-none focus:border-blue-500"})]}),(0,a.jsxs)("div",{className:"w-36",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Model"}),(0,a.jsx)("select",{value:o.model||"",onChange:e=>d({...o,model:e.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded px-2 py-1.5 text-sm focus:outline-none focus:border-blue-500",children:s.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{className:"w-16",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"WPM"}),(0,a.jsx)("input",{type:"number",value:o.room_wpm||80,onChange:e=>d({...o,room_wpm:parseInt(e.target.value)}),className:"w-full bg-gray-700 border border-gray-600 rounded px-2 py-1.5 text-sm focus:outline-none focus:border-blue-500"})]}),(0,a.jsxs)("div",{className:"w-32",children:[(0,a.jsxs)("label",{className:"block text-xs text-gray-400 mb-1",children:["Speed: ",(o.heartbeat_interval||5).toFixed(1),"s"]}),(0,a.jsx)("input",{type:"range",min:"1",max:"10",step:"0.5",value:o.heartbeat_interval||5,onChange:e=>d({...o,heartbeat_interval:parseFloat(e.target.value)}),className:"w-full mt-1"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,a.jsx)("label",{className:"text-xs text-gray-400",children:"Background"}),(0,a.jsxs)("label",{className:"flex items-center gap-1.5 cursor-pointer ml-auto",children:[(0,a.jsx)("input",{type:"checkbox",checked:o.can_create_agents||!1,onChange:e=>d({...o,can_create_agents:e.target.checked}),className:"w-3.5 h-3.5 rounded bg-gray-700 border-gray-600"}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"Can create agents"})]}),(0,a.jsx)("button",{onClick:()=>{t&&l(t.id,o)},className:"bg-blue-600 hover:bg-blue-700 text-white py-1 px-3 rounded text-sm transition-colors",children:"Save"})]}),(0,a.jsx)("textarea",{value:o.background_prompt||"",onChange:e=>d({...o,background_prompt:e.target.value}),className:"flex-1 w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500 resize-none min-h-[60px]",placeholder:"Agent background/personality..."})]}):(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Select an agent to edit"})})]})}let d={idle:"text-green-400",thinking:"text-orange-400",typing:"text-blue-400",sending:"text-purple-400",sleeping:"text-gray-400"};function x(e){let{roomId:t,members:s,availableAgents:l,onAddMember:r,onRemoveMember:i}=e,[c,o]=(0,n.useState)(""),x=new Set(s.map(e=>e.agent_id)),m=l.filter(e=>!x.has(e.id));return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"font-semibold",children:"Room Members"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("select",{value:c,onChange:e=>o(e.target.value),className:"bg-gray-700 border border-gray-600 rounded-lg px-2 py-1 text-sm focus:outline-none focus:border-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Add agent..."}),m.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.id,": ",e.name||"Unnamed"]},e.id))]}),(0,a.jsx)("button",{onClick:()=>{c&&(r(parseInt(c)),o(""))},disabled:!c,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-3 py-1 rounded-lg text-sm transition-colors",children:"+"})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:t?0===s.length?(0,a.jsx)("p",{className:"text-gray-500 text-center",children:"No members in room"}):(0,a.jsx)("div",{className:"space-y-1",children:s.sort((e,t)=>e.is_owner?-1:t.is_owner?1:e.agent_id-t.agent_id).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-gray-700/30",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:e.is_owner?"text-yellow-400":"text-blue-400",children:e.is_owner?"★":"  "}),(0,a.jsxs)("span",{children:[e.agent_name||"Unnamed",(0,a.jsxs)("span",{className:"text-gray-500 text-sm",children:[" (#",e.agent_id,")"]})]}),(0,a.jsxs)("span",{className:"text-sm ".concat(d[e.status]||d.idle),children:["● ",e.status]})]}),!e.is_owner&&(0,a.jsx)("button",{onClick:()=>i(e.agent_id),className:"text-gray-500 hover:text-red-400 px-2 transition-colors",title:"Remove from room",children:"\xd7"})]},e.agent_id))}):(0,a.jsx)("p",{className:"text-gray-500 text-center",children:"No room selected"})})]})}function m(e){let{roomId:t,messages:s,agents:l,heartbeatRunning:r,onSendMessage:i,onClearMessages:c,onToggleHeartbeat:o}=e,[d,x]=(0,n.useState)(""),m=(0,n.useRef)(null);(0,n.useEffect)(()=>{var e;null===(e=m.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[s]);let u=()=>{d.trim()&&(i(d.trim()),x(""))},h=e=>{if("The Architect"===e||"User"===e||"System"===e)return e;let t=parseInt(e);if(!isNaN(t)){let e=l.find(e=>e.id===t);return e?"".concat(e.name," (#").concat(t,")"):"Agent #".concat(t)}return e},g=e=>"The Architect"===e||"User"===e?"chat-message chat-message-user":"System"===e?"chat-message chat-message-system":"chat-message chat-message-agent",p=e=>{try{return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(e){return""}};return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,a.jsx)("h2",{className:"font-semibold",children:"Chat Room"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:c,disabled:!t,className:"bg-gray-600 hover:bg-gray-500 disabled:opacity-50 disabled:cursor-not-allowed text-white py-1 px-3 rounded-lg text-sm transition-colors",children:"Clear"}),(0,a.jsx)("button",{onClick:o,className:"py-1 px-3 rounded-lg text-sm transition-colors ".concat(r?"bg-red-600 hover:bg-red-700 text-white":"bg-green-600 hover:bg-green-700 text-white"),children:r?"⏹ Stop":"▶ Start"})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-2 font-mono text-sm",children:[t?0===s.length?(0,a.jsx)("p",{className:"text-gray-500 text-center",children:"No messages yet"}):s.map(e=>(0,a.jsxs)("div",{className:g(e.sender_name),children:[(0,a.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,a.jsxs)("span",{className:"text-gray-500 text-xs",children:["[",p(e.timestamp),"]"]}),(0,a.jsxs)("span",{className:"font-semibold text-blue-400",children:[h(e.sender_name),":"]})]}),(0,a.jsx)("p",{className:"mt-1 whitespace-pre-wrap",children:e.content})]},e.id)):(0,a.jsx)("p",{className:"text-gray-500 text-center",children:"Select an agent to view their room"}),(0,a.jsx)("div",{ref:m})]}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-700",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:d,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u())},placeholder:"Type a message...",disabled:!t,className:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 disabled:opacity-50"}),(0,a.jsx)("button",{onClick:u,disabled:!t||!d.trim(),className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white py-2 px-6 rounded-lg transition-colors",children:"Send"})]})})]})}function u(e){let{onOpenSettings:t,onOpenHUDHistory:s,onOpenKnowledge:l,onOpenTelemetry:r,onOpenHUDEditor:i,apiConnected:c,heartbeatRunning:o}=e,[d,x]=(0,n.useState)(!1);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>x(!d),className:"flex items-center gap-2 px-3 py-1.5 rounded text-sm transition-colors ".concat(d?"bg-gray-700 text-white":"bg-gray-800 text-gray-400 hover:text-white hover:bg-gray-700"),children:[(0,a.jsx)("span",{children:"Tools"}),(0,a.jsx)("span",{className:"transform transition-transform ".concat(d?"rotate-180":""),children:"▾"})]}),d&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>x(!1)}),(0,a.jsxs)("div",{className:"absolute top-full left-0 mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50 w-56",children:[[{id:"settings",label:"Settings",icon:"⚙",description:"API key & app settings",onClick:t},{id:"hud",label:"HUD History",icon:"\uD83D\uDCDC",description:"View agent HUD interactions",onClick:s},{id:"knowledge",label:"Knowledge",icon:"\uD83E\uDDE0",description:"Explore agent self-concept",onClick:l},{id:"telemetry",label:"Telemetry",icon:"\uD83D\uDCCA",description:"TOON token optimization stats",onClick:r},{id:"hud-editor",label:"HUD Editor",icon:"\uD83D\uDCDD",description:"Edit agent prompts & behaviors",onClick:i}].map(e=>(0,a.jsxs)("button",{onClick:()=>{e.onClick(),x(!1)},className:"w-full flex items-start gap-3 px-4 py-3 hover:bg-gray-700/50 transition-colors text-left first:rounded-t-lg last:rounded-b-lg",children:[(0,a.jsx)("span",{className:"text-lg",children:e.icon}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:e.label}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]})]},e.id)),(0,a.jsxs)("div",{className:"border-t border-gray-700 px-4 py-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(c?"bg-green-400":"bg-red-400")}),(0,a.jsxs)("span",{className:"text-gray-400",children:["API: ",c?"Connected":"Disconnected"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs mt-1",children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(o?"bg-green-400":"bg-gray-500")}),(0,a.jsxs)("span",{className:"text-gray-400",children:["Heartbeat: ",o?"Running":"Stopped"]})]})]})]})]})]})}async function h(e,t){let s=await fetch("".concat("http://localhost:8000").concat(e),{...t,headers:{"Content-Type":"application/json",...null==t?void 0:t.headers}});if(!s.ok)throw Error((await s.json().catch(()=>({detail:"Unknown error"}))).detail||"API error: ".concat(s.status));return s.json()}async function g(){return h("/api/agents")}async function p(e){return h("/api/agents",{method:"POST",body:JSON.stringify(e)})}async function y(e,t){return h("/api/agents/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async function f(e){await h("/api/agents/".concat(e),{method:"DELETE"})}async function b(e,t){return h(void 0!==t?"/api/rooms/".concat(e,"/messages?since=").concat(t):"/api/rooms/".concat(e,"/messages"))}async function j(e,t,s,a){return h("/api/rooms/".concat(e,"/messages"),{method:"POST",body:JSON.stringify({sender_name:t,content:s,reply_to_id:a})})}async function v(e){await h("/api/rooms/".concat(e,"/messages"),{method:"DELETE"})}async function N(e){return h("/api/rooms/".concat(e,"/members"))}async function w(e,t){await h("/api/rooms/".concat(e,"/members/").concat(t),{method:"POST"})}async function k(e,t){await h("/api/rooms/".concat(e,"/members/").concat(t),{method:"DELETE"})}async function C(){return h("/api/heartbeat/status")}async function D(){await h("/api/heartbeat/start",{method:"POST"})}async function S(){await h("/api/heartbeat/stop",{method:"POST"})}async function _(){return h("/api/settings/status")}async function O(e){await h("/api/settings/apikey",{method:"POST",body:JSON.stringify({api_key:e})})}async function A(){return h("/api/settings/models")}async function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return h("/api/agents/".concat(e,"/hud-history?limit=").concat(t))}async function T(e){await h("/api/agents/".concat(e,"/hud-history"),{method:"DELETE"})}async function F(e){return h("/api/agents/".concat(e,"/knowledge"))}async function P(e,t){await h("/api/agents/".concat(e,"/knowledge"),{method:"PUT",body:JSON.stringify(t)})}async function U(){return h("/api/telemetry/toon")}async function I(){return h("/api/prompts")}async function M(e){await h("/api/prompts",{method:"PUT",body:JSON.stringify(e)})}function R(e){let{isOpen:t,onClose:s,apiStatus:l,onApiKeySet:r}=e,[i,c]=(0,n.useState)(""),[o,d]=(0,n.useState)(!1),[x,m]=(0,n.useState)(null);(0,n.useEffect)(()=>{t&&(c(""),m(null))},[t]);let u=async()=>{if(!i.trim()){m({text:"Please enter an API key",type:"error"});return}d(!0),m(null);try{await O(i.trim()),m({text:"API key saved successfully!",type:"success"}),c(""),r()}catch(e){m({text:e.message||"Failed to save API key",type:"error"})}finally{d(!1)}};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:s,children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-lg mx-4",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Settings"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors",children:"✕"})]}),(0,a.jsxs)("div",{className:"p-4 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"API Status"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full ".concat((null==l?void 0:l.connected)?"bg-green-400":"bg-red-400")}),(0,a.jsx)("span",{className:"text-sm",children:(null==l?void 0:l.connected)?"Connected to OpenAI":"Not connected"})]}),(null==l?void 0:l.message)&&(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:l.message}),(null==l?void 0:l.models)&&l.models.length>0&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[l.models.length," models available"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"OpenAI API Key"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"password",value:i,onChange:e=>c(e.target.value),placeholder:"sk-...",className:"flex-1 bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500"}),(0,a.jsx)("button",{onClick:u,disabled:o,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white px-4 py-2 rounded text-sm transition-colors",children:o?"Saving...":"Save"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Your API key is stored locally and used to communicate with OpenAI."})]}),x&&(0,a.jsx)("div",{className:"p-3 rounded text-sm ".concat("success"===x.type?"bg-green-900/50 text-green-300":"bg-red-900/50 text-red-300"),children:x.text}),(0,a.jsxs)("div",{className:"border-t border-gray-700 pt-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"About"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"AI Chat Room - A multi-agent chat application with autonomous AI agents."}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Agents communicate through a heartbeat system and maintain their own self-concept."})]})]}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-700 flex justify-end",children:(0,a.jsx)("button",{onClick:s,className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm transition-colors",children:"Close"})})]})}):null}function H(e){let{data:t,maxTokens:s}=e;if(0===t.length)return null;let n=t.slice(-20).map((e,t,a)=>{let n=t/(a.length-1||1)*60;return"".concat(n,",").concat(24-e/s*24)}).join(" ");return(0,a.jsx)("svg",{width:60,height:24,className:"inline-block ml-2",children:(0,a.jsx)("polyline",{points:n,fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:"text-blue-400"})})}function L(e){let{history:t}=e;if(0===t.length)return null;let s=Math.max(...t.map(e=>e.tokens||0),1),n=t.slice(-30);return(0,a.jsx)("div",{className:"h-16 flex items-end gap-px",children:n.map((e,t)=>{let n=(e.tokens||0)/s*100,l=!!e.error;return(0,a.jsx)("div",{className:"flex-1 min-w-[3px] max-w-[12px] rounded-t transition-all ".concat(l?"bg-red-500/70":"bg-blue-500/70"," hover:bg-blue-400"),style:{height:"".concat(Math.max(n,4),"%")},title:"".concat(e.tokens," tokens - ").concat(new Date(e.timestamp).toLocaleTimeString())},t)})})}function J(e){let{content:t}=e,[s,l]=(0,n.useState)(new Set(["sys","me","r"])),r=(0,n.useMemo)(()=>{if(!t)return null;try{return JSON.parse(t)}catch(e){return null}},[t]),i=e=>{l(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},c=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null==e)return(0,a.jsx)("span",{className:"text-gray-500",children:"null"});if("boolean"==typeof e)return(0,a.jsx)("span",{className:"text-yellow-400",children:e?"true":"false"});if("number"==typeof e)return(0,a.jsx)("span",{className:"text-blue-400",children:e});if("string"==typeof e)return e.length>100?(0,a.jsxs)("span",{className:"text-green-400",children:['"',e.slice(0,100),'..."',(0,a.jsxs)("span",{className:"text-gray-500 text-xs ml-1",children:["(",e.length," chars)"]})]}):(0,a.jsxs)("span",{className:"text-green-400",children:['"',e,'"']});if(Array.isArray(e)){if(0===e.length)return(0,a.jsx)("span",{className:"text-gray-500",children:"[]"});let l=s.has(t);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>i(t),className:"text-gray-400 hover:text-white",children:[l?"▼":"▶",(0,a.jsxs)("span",{className:"text-purple-400 ml-1",children:["Array(",e.length,")"]})]}),l&&(0,a.jsx)("div",{style:{marginLeft:16*n+16},children:e.map((e,s)=>(0,a.jsxs)("div",{className:"border-l border-gray-700 pl-2 my-1",children:[(0,a.jsxs)("span",{className:"text-gray-500 text-xs",children:["[",s,"]"]})," ",c(e,"".concat(t,"[").concat(s,"]"),n+1)]},s))})]})}if("object"==typeof e){let l=Object.entries(e);if(0===l.length)return(0,a.jsx)("span",{className:"text-gray-500",children:"{}"});let r=s.has(t),o=t.split(".").pop()||t;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>i(t),className:"text-gray-400 hover:text-white flex items-center gap-1",children:[r?"▼":"▶",(0,a.jsx)("span",{className:"text-purple-400",children:{sys:"\uD83D\uDD27 System",me:"\uD83D\uDC64 Self",m:"\uD83D\uDCCB Meta",r:"\uD83D\uDEAA Rooms",system:"\uD83D\uDD27 System",self:"\uD83D\uDC64 Self",meta:"\uD83D\uDCCB Meta",rooms:"\uD83D\uDEAA Rooms"}[o]||o}),(0,a.jsxs)("span",{className:"text-gray-600 text-xs",children:["(",l.length," keys)"]})]}),r&&(0,a.jsx)("div",{className:"ml-4 border-l border-gray-700/50 pl-2",children:l.map(e=>{let[s,l]=e;return(0,a.jsxs)("div",{className:"my-1",children:[(0,a.jsx)("span",{className:"text-cyan-400",children:s}),(0,a.jsx)("span",{className:"text-gray-500",children:": "}),c(l,"".concat(t,".").concat(s),n+1)]},s)})})]})}return(0,a.jsx)("span",{children:String(e)})};return r?(0,a.jsx)("div",{className:"font-mono text-sm",children:c(r,"root",0)}):(0,a.jsx)(z,{content:t})}function z(e){let{content:t}=e,s=(0,n.useMemo)(()=>t?t.replace(/^(\w+)\{([^}]+)\}:/gm,'<span class="text-purple-400">$1</span>{<span class="text-cyan-400">$2</span>}:').replace(/(\w+)\[(\d+)\]\{([^}]+)\}:/g,'<span class="text-purple-400">$1</span>[<span class="text-blue-400">$2</span>]{<span class="text-cyan-400">$3</span>}:').replace(/"([^"]+)"/g,'<span class="text-green-400">"$1"</span>').replace(/\b(\d+(?:\.\d+)?)\b/g,'<span class="text-blue-400">$1</span>').replace(/\b(true|false|null)\b/g,'<span class="text-yellow-400">$1</span>'):"",[t]);return(0,a.jsx)("pre",{className:"text-sm text-gray-300 whitespace-pre-wrap font-mono",dangerouslySetInnerHTML:{__html:s||"(no content)"}})}function K(e){let{current:t,previous:s}=e;if(!s)return(0,a.jsx)("div",{className:"text-gray-500 text-center py-8",children:"No previous entry to compare"});let n=t.split("\n"),l=s.split("\n"),r=Math.max(n.length,l.length),i=[];for(let e=0;e<r;e++){let t=n[e],s=l[e];t===s?i.push({type:"same",current:t}):t&&!s?i.push({type:"added",current:t}):!t&&s?i.push({type:"removed",previous:s}):i.push({type:"changed",current:t,previous:s})}let c=i.filter(e=>"same"!==e.type).length;return(0,a.jsxs)("div",{className:"font-mono text-sm",children:[(0,a.jsxs)("div",{className:"mb-3 text-xs text-gray-400",children:[c," line",1!==c?"s":""," changed"]}),(0,a.jsx)("div",{className:"space-y-0.5",children:i.map((e,t)=>"same"===e.type?(0,a.jsx)("div",{className:"text-gray-500 pl-4",children:e.current||" "},t):"added"===e.type?(0,a.jsxs)("div",{className:"bg-green-900/30 text-green-300 pl-4 border-l-2 border-green-500",children:["+ ",e.current]},t):"removed"===e.type?(0,a.jsxs)("div",{className:"bg-red-900/30 text-red-300 pl-4 border-l-2 border-red-500",children:["- ",e.previous]},t):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"bg-red-900/30 text-red-300 pl-4 border-l-2 border-red-500",children:["- ",e.previous]}),(0,a.jsxs)("div",{className:"bg-green-900/30 text-green-300 pl-4 border-l-2 border-green-500",children:["+ ",e.current]})]},t))})]})}function $(e){let{isOpen:t,onClose:s,agent:l}=e,[r,i]=(0,n.useState)([]),[c,o]=(0,n.useState)(null),[d,x]=(0,n.useState)(!1),[m,u]=(0,n.useState)("structured"),[h,g]=(0,n.useState)(""),p=(0,n.useRef)(null),y=null!==c?r[c]:null,f=null!==c&&c<r.length-1?r[c+1]:null;(0,n.useEffect)(()=>{t&&l&&b()},[t,l]);let b=async()=>{if(l){x(!0);try{let e=await E(l.id,100);i(e),o(null)}catch(e){console.error("Failed to fetch HUD history:",e)}finally{x(!1)}}},j=async()=>{if(l&&confirm("Clear all HUD history for this agent?"))try{await T(l.id),i([]),o(null)}catch(e){console.error("Failed to clear HUD history:",e)}},v=(0,n.useMemo)(()=>{if(!h)return r;let e=h.toLowerCase();return r.filter(t=>{var s,a,n;return(null===(s=t.response)||void 0===s?void 0:s.toLowerCase().includes(e))||(null===(a=t.hud)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(n=t.error)||void 0===n?void 0:n.toLowerCase().includes(e))})},[r,h]),N=(0,n.useMemo)(()=>{if(0===r.length)return null;let e=r.map(e=>e.tokens||0),t=r.filter(e=>e.error).length;return{total:r.length,totalTokens:e.reduce((e,t)=>e+t,0),avgTokens:Math.round(e.reduce((e,t)=>e+t,0)/e.length),maxTokens:Math.max(...e),minTokens:Math.min(...e),errors:t,successRate:Math.round((r.length-t)/r.length*100)}},[r]),w=e=>{let t=new Date,s=new Date(e),a=t.getTime()-s.getTime();return a<6e4?"just now":a<36e5?"".concat(Math.floor(a/6e4),"m ago"):a<864e5?"".concat(Math.floor(a/36e5),"h ago"):"".concat(Math.floor(a/864e5),"d ago")},k=e=>e>=1e3?"".concat((e/1e3).toFixed(1),"k"):e.toString();return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:s,children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-6xl mx-4 max-h-[90vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 flex-shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"HUD History"}),l&&(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:[l.name," (ID: ",l.id,")"]})]}),N&&(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-400 border-l border-gray-700 pl-4",children:[(0,a.jsxs)("span",{children:[N.total," entries"]}),(0,a.jsxs)("span",{children:[k(N.totalTokens)," total tokens"]}),(0,a.jsxs)("span",{className:N.successRate<90?"text-yellow-400":"text-green-400",children:[N.successRate,"% success"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search...",value:h,onChange:e=>g(e.target.value),className:"bg-gray-700 border border-gray-600 rounded px-2 py-1 text-sm w-32 focus:outline-none focus:border-blue-500"}),(0,a.jsx)("button",{onClick:b,className:"text-gray-400 hover:text-white transition-colors px-2",title:"Refresh",children:"↻"}),(0,a.jsx)("button",{onClick:j,className:"text-red-400 hover:text-red-300 transition-colors text-sm px-2",children:"Clear"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors ml-2",children:"✕"})]})]}),r.length>0&&(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-700/50 bg-gray-800/50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Token Usage (last 30 interactions)"}),N&&(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["avg: ",k(N.avgTokens)," | max: ",k(N.maxTokens)]})]}),(0,a.jsx)(L,{history:r})]}),(0,a.jsx)("div",{className:"flex-1 flex min-h-0",children:l?d?(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:"Loading..."}):0===v.length?(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:h?"No matching entries":"No HUD history available"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{ref:p,className:"w-80 border-r border-gray-700 overflow-y-auto flex-shrink-0",children:v.map((e,t)=>{var s;let n=r.indexOf(e),l=c===n;return(0,a.jsxs)("button",{onClick:()=>o(n),className:"w-full text-left p-3 border-b border-gray-700/50 hover:bg-gray-700/50 transition-colors ".concat(l?"bg-gray-700":""),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-gray-400",children:w(e.timestamp)}),(0,a.jsx)(H,{data:r.slice(Math.max(0,n-5),n+1).map(e=>e.tokens||0),maxTokens:(null==N?void 0:N.maxTokens)||1e3})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded ".concat(e.error?"bg-red-900/50 text-red-300":"bg-green-900/50 text-green-300"),children:e.error?"ERR":"OK"}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[k(e.tokens||0)," tok"]}),e.hud_tokens&&(0,a.jsxs)("span",{className:"text-xs text-gray-600",children:["(",k(e.hud_tokens)," HUD)"]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-300 mt-1 truncate",children:(null===(s=e.response)||void 0===s?void 0:s.slice(0,60))||"(no response)"})]},t)})}),(0,a.jsx)("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-700 flex-shrink-0 bg-gray-800/50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-gray-300",children:new Date(y.timestamp).toLocaleString()}),(0,a.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:["(",w(y.timestamp),")"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[y.hud_tokens&&(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"HUD:"}),(0,a.jsx)("span",{className:"text-blue-400 ml-1",children:k(y.hud_tokens)})]}),(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Total:"}),(0,a.jsx)("span",{className:"text-blue-400 ml-1",children:k(y.tokens||0)})]})]})]}),y.error&&(0,a.jsx)("div",{className:"mt-2 p-2 bg-red-900/30 rounded text-sm text-red-300",children:y.error})]}),(0,a.jsxs)("div",{className:"flex border-b border-gray-700 flex-shrink-0 bg-gray-800/30",children:[(0,a.jsx)("button",{onClick:()=>u("structured"),className:"px-4 py-2 text-sm flex items-center gap-1 ".concat("structured"===m?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-white"),children:"\uD83C\uDF33 Structured"}),(0,a.jsx)("button",{onClick:()=>u("raw"),className:"px-4 py-2 text-sm flex items-center gap-1 ".concat("raw"===m?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-white"),children:"\uD83D\uDCC4 Raw HUD"}),(0,a.jsx)("button",{onClick:()=>u("response"),className:"px-4 py-2 text-sm flex items-center gap-1 ".concat("response"===m?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-white"),children:"\uD83D\uDCAC Response"}),(0,a.jsxs)("button",{onClick:()=>u("diff"),className:"px-4 py-2 text-sm flex items-center gap-1 ".concat("diff"===m?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-white"),children:["⟷ Diff",f&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(vs prev)"})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto p-4",children:["structured"===m&&(0,a.jsx)(J,{content:y.hud||""}),"raw"===m&&(0,a.jsx)(z,{content:y.hud||"(no HUD content)"}),"response"===m&&(0,a.jsx)("pre",{className:"text-sm text-gray-300 whitespace-pre-wrap font-mono",children:y.response||"(no response)"}),"diff"===m&&(0,a.jsx)(K,{current:y.hud||"",previous:(null==f?void 0:f.hud)||null})]})]}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCDC"}),(0,a.jsx)("div",{children:"Select an entry to view details"}),(0,a.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"Click any entry on the left"})]})})})]}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Select an agent to view HUD history"})}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-700 flex justify-between items-center flex-shrink-0",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[v.length," of ",r.length," entries",h&&(0,a.jsxs)("span",{className:"ml-2",children:['matching "',h,'"']})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>o(e=>null!==e&&e>0?e-1:e),disabled:null===c||0===c,className:"text-gray-400 hover:text-white disabled:text-gray-600 px-2",title:"Newer entry",children:"← Newer"}),(0,a.jsx)("button",{onClick:()=>o(e=>null!==e&&e<r.length-1?e+1:e),disabled:null===c||c===r.length-1,className:"text-gray-400 hover:text-white disabled:text-gray-600 px-2",title:"Older entry",children:"Older →"}),(0,a.jsx)("button",{onClick:s,className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm transition-colors ml-4",children:"Close"})]})]})]})}):null}function B(e){let{isOpen:t,onClose:s,agent:l}=e,[r,i]=(0,n.useState)({}),[c,o]=(0,n.useState)(new Set([""])),[d,x]=(0,n.useState)(!1),[m,u]=(0,n.useState)(null),[h,g]=(0,n.useState)(""),[p,y]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t&&l&&f()},[t,l]);let f=async()=>{if(l){x(!0);try{let e=await F(l.id);i(e)}catch(e){console.error("Failed to fetch knowledge:",e),i({})}finally{x(!1)}}},b=e=>{o(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},j=e=>"object"==typeof e&&null!==e,v=e=>null===e?"null":void 0===e?"undefined":"string"==typeof e?'"'.concat(e,'"'):"number"==typeof e||"boolean"==typeof e?String(e):Array.isArray(e)?"Array(".concat(e.length,")"):"object"==typeof e?"Object(".concat(Object.keys(e).length,")"):String(e),N=e=>null==e?"text-gray-500":"string"==typeof e?"text-green-400":"number"==typeof e?"text-blue-400":"boolean"==typeof e?"text-yellow-400":"text-gray-300",w=(e,t)=>{u(e),g("string"==typeof t?t:JSON.stringify(t,null,2))},k=()=>{u(null),g("")},C=async()=>{if(l&&null!==m){y(!0);try{let e;try{e=JSON.parse(h)}catch(t){e=h}let t=m.split(".").filter(e=>e),s=JSON.parse(JSON.stringify(r));if(0===t.length)await P(l.id,"object"==typeof e?e:{value:e});else{let a=s;for(let e=0;e<t.length-1;e++)a=a[t[e]];a[t[t.length-1]]=e,await P(l.id,s)}await f(),u(null),g("")}catch(e){console.error("Failed to save:",e),alert("Failed to save changes")}finally{y(!1)}}},D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=[];for(let[l,r]of Object.entries(e)){let e=t?"".concat(t,".").concat(l):l,i=c.has(e),o=j(r),d=m===e;n.push((0,a.jsxs)("div",{className:"font-mono",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 py-1 hover:bg-gray-700/30 rounded px-2 group",style:{paddingLeft:"".concat(16*s+8,"px")},children:[o?(0,a.jsx)("button",{onClick:()=>b(e),className:"w-4 h-4 flex items-center justify-center text-gray-500 hover:text-white",children:i?"▼":"▶"}):(0,a.jsx)("span",{className:"w-4"}),(0,a.jsx)("span",{className:"text-purple-400",children:l}),(0,a.jsx)("span",{className:"text-gray-500",children:":"}),d?(0,a.jsxs)("div",{className:"flex-1 flex items-center gap-2 ml-2",children:[(0,a.jsx)("input",{type:"text",value:h,onChange:e=>g(e.target.value),className:"flex-1 bg-gray-700 border border-gray-600 rounded px-2 py-0.5 text-sm focus:outline-none focus:border-blue-500",autoFocus:!0}),(0,a.jsx)("button",{onClick:C,disabled:p,className:"text-green-400 hover:text-green-300 text-sm",children:"✓"}),(0,a.jsx)("button",{onClick:k,className:"text-red-400 hover:text-red-300 text-sm",children:"✕"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"ml-1 ".concat(N(r)),children:v(r)}),!o&&(0,a.jsx)("button",{onClick:()=>w(e,r),className:"ml-2 text-gray-600 hover:text-gray-400 opacity-0 group-hover:opacity-100 text-xs",children:"edit"})]})]}),o&&i&&(0,a.jsx)("div",{children:D(r,e,s+1)})]},e))}return n};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:s,children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-3xl mx-4 max-h-[80vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 flex-shrink-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Knowledge Explorer"}),l&&(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:[l.name,"'s Self-Concept"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:f,className:"text-gray-400 hover:text-white transition-colors px-2",title:"Refresh",children:"↻"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors",children:"✕"})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto p-4 min-h-0",children:l?d?(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400",children:"Loading..."}):0===Object.keys(r).length?(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No knowledge data available"}):(0,a.jsx)("div",{className:"text-sm",children:D(r)}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:"Select an agent to view their knowledge"})}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-700 flex justify-between items-center flex-shrink-0",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[Object.keys(r).length," top-level keys"]}),(0,a.jsx)("button",{onClick:s,className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm transition-colors",children:"Close"})]})]})}):null}function Z(e){let t,{isOpen:s,onClose:l}=e,[r,i]=(0,n.useState)(null),[c,o]=(0,n.useState)(!1);(0,n.useEffect)(()=>{s&&d()},[s]);let d=async()=>{o(!0);try{let e=await U();i(e)}catch(e){console.error("Failed to fetch telemetry:",e)}finally{o(!1)}},x=e=>e.toLocaleString();return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:l,children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl mx-4 max-h-[80vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 flex-shrink-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"TOON Telemetry"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Token Optimization Statistics"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:d,className:"text-gray-400 hover:text-white transition-colors px-2",title:"Refresh",children:"↻"}),(0,a.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-white transition-colors",children:"✕"})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto p-4 min-h-0",children:c?(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400",children:"Loading..."}):r?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:x(r.total_comparisons)}),(0,a.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:"Total Comparisons"})]}),(0,a.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-400",children:(t=r.savings_percentage,"".concat(t.toFixed(1),"%"))}),(0,a.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:"Token Savings"})]}),(0,a.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-400",children:x(r.estimated_json_tokens)}),(0,a.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:"JSON Tokens"})]}),(0,a.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:x(r.estimated_optimized_tokens)}),(0,a.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:"Optimized Tokens"})]})]}),(0,a.jsxs)("div",{className:"bg-gray-700/30 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Character Analysis"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"JSON Characters:"}),(0,a.jsx)("span",{children:x(r.json_chars)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Optimized Characters:"}),(0,a.jsx)("span",{children:x(r.optimized_chars)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Characters Saved:"}),(0,a.jsx)("span",{className:"text-green-400",children:x(r.char_savings)})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[(0,a.jsx)("span",{children:"Optimized"}),(0,a.jsx)("span",{children:"Original JSON"})]}),(0,a.jsx)("div",{className:"h-4 bg-gray-600 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-green-500 to-green-400",style:{width:"".concat(100-r.savings_percentage,"%")}})})]})]}),r.entries&&r.entries.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Recent Optimizations"}),(0,a.jsx)("div",{className:"space-y-2 max-h-48 overflow-auto",children:r.entries.slice(-20).reverse().map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm bg-gray-700/30 rounded px-3 py-2",children:[(0,a.jsx)("span",{className:"text-gray-400 text-xs",children:new Date(e.timestamp).toLocaleTimeString()}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"text-gray-500",children:[e.json_tokens," → ",e.optimized_tokens]}),(0,a.jsxs)("span",{className:"text-green-400",children:["-",e.savings]})]})]},t))})]})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No telemetry data available"})}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-700 flex justify-end flex-shrink-0",children:(0,a.jsx)("button",{onClick:l,className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm transition-colors",children:"Close"})})]})}):null}let W={technical:"⚙️",philosophy:"\uD83E\uDDE0",response_format:"\uD83D\uDCDD",actions:"⚡",knowledge:"\uD83D\uDCBE",reactions:"\uD83D\uDC4D",room_access:"\uD83D\uDD10",attention:"\uD83D\uDC41️",topics:"\uD83D\uDCAC",settings:"\uD83D\uDD27",identity:"\uD83D\uDC64",communication:"\uD83D\uDCE1",silence:"\uD83E\uDD2B",memory:"\uD83E\uDDE9",own_room:"\uD83C\uDFE0",time:"⏰"};function V(e,t){let s=t.split("."),a=e;for(let e of s){if("object"!=typeof a||null===a)return null;a=a[e]}return a}function Y(e,t,s){let a=JSON.parse(JSON.stringify(e)),n=t.split("."),l=a;for(let e=0;e<n.length-1;e++)n[e]in l||(l[n[e]]={}),l=l[n[e]];return l[n[n.length-1]]=s,a}function q(e){var t,s;let{isOpen:l,onClose:r}=e,[i,c]=(0,n.useState)({}),[o,d]=(0,n.useState)(null),[x,m]=(0,n.useState)(""),[u,h]=(0,n.useState)(""),[g,p]=(0,n.useState)(!1),[y,f]=(0,n.useState)(!1),[b,j]=(0,n.useState)(!1),[v,N]=(0,n.useState)(new Set(["technical","philosophy"])),[w,k]=(0,n.useState)(!1),[C,D]=(0,n.useState)(""),[S,_]=(0,n.useState)(null);(0,n.useEffect)(()=>{l&&O()},[l]),(0,n.useEffect)(()=>{if(o){let e=V(i,o);e&&"object"==typeof e&&(m(e.description||""),h(e.content||""))}},[o,i]);let O=async()=>{p(!0);try{let e=await I();c(e),j(!1)}catch(e){console.error("Failed to fetch prompts:",e)}finally{p(!1)}},A=async()=>{f(!0);try{await M(i),j(!1)}catch(e){console.error("Failed to save prompts:",e),alert("Failed to save prompts")}finally{f(!1)}},E=e=>{if(!C.trim())return;let t=C.trim().toLowerCase().replace(/\s+/g,"_"),s=e?"".concat(e,".").concat(t):t;c(Y(i,s,{description:"Description for ".concat(C),content:""})),j(!0),d(s),D(""),_(null),e&&N(t=>new Set([...Array.from(t),e]))},T=e=>{confirm('Delete section "'.concat(e,'"? This cannot be undone.'))&&(c(function(e,t){let s=JSON.parse(JSON.stringify(e)),a=t.split("."),n=s;for(let e=0;e<a.length-1;e++){if(!(a[e]in n))return s;n=n[a[e]]}return delete n[a[a.length-1]],s}(i,e)),j(!0),o===e&&d(null))},F=e=>{N(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},P=(0,n.useMemo)(()=>(function e(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=[];for(let[l,r]of Object.entries(t)){if("description"===l||"content"===l)continue;let t=s?"".concat(s,".").concat(l):l,i="object"==typeof r&&null!==r&&"content"in r,c="object"==typeof r&&null!==r?Object.keys(r).filter(e=>"description"!==e&&"content"!==e):[],o=c.length>0;if(n.push({path:t,key:l,depth:a,hasContent:i,hasChildren:o,description:"object"==typeof r&&null!==r?r.description:void 0}),"object"==typeof r&&null!==r){let s={};for(let e of c)s[e]=r[e];n.push(...e(s,t,a+1))}}return n})(i),[i]),U=(0,n.useMemo)(()=>{let e=[];for(let t of P){if(0===t.depth){e.push(t);continue}let s=t.path.split("."),a=!0;for(let e=1;e<s.length;e++){let t=s.slice(0,e).join(".");if(!v.has(t)){a=!1;break}}a&&e.push(t)}return e},[P,v]);if((0,n.useMemo)(()=>{var e;if(!o)return"";let t=V(i,o);if(!t||"object"!=typeof t)return"";let s=[],a=(null===(e=o.split(".").pop())||void 0===e?void 0:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()))||"";return t.content&&(s.push("## ".concat(a)),s.push(t.content)),s.join("\n")},[o,i]),!l)return null;let R=o?V(i,o):null;return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:r,children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-6xl mx-4 max-h-[90vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 flex-shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"HUD Prompt Editor"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Configure agent prompts and behaviors"})]}),b&&(0,a.jsx)("span",{className:"text-xs bg-yellow-900/50 text-yellow-300 px-2 py-1 rounded",children:"Unsaved changes"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:O,className:"text-gray-400 hover:text-white transition-colors px-2",title:"Reload",children:"↻"}),(0,a.jsx)("button",{onClick:A,disabled:y||!b,className:"px-4 py-1.5 rounded text-sm transition-colors ".concat(b?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-700 text-gray-500"),children:y?"Saving...":"Save All"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors ml-2",children:"✕"})]})]}),(0,a.jsx)("div",{className:"flex-1 flex min-h-0",children:g?(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:"Loading..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-72 border-r border-gray-700 overflow-y-auto flex-shrink-0",children:(0,a.jsxs)("div",{className:"p-2",children:[""===S?(0,a.jsxs)("div",{className:"flex items-center gap-1 p-2 bg-gray-700 rounded mb-2",children:[(0,a.jsx)("input",{type:"text",value:C,onChange:e=>D(e.target.value),placeholder:"Section name",className:"flex-1 bg-gray-600 border-none rounded px-2 py-1 text-sm focus:outline-none",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&E(null),"Escape"===e.key&&_(null)}}),(0,a.jsx)("button",{onClick:()=>E(null),className:"text-green-400 hover:text-green-300 px-1",children:"✓"}),(0,a.jsx)("button",{onClick:()=>_(null),className:"text-gray-400 hover:text-white px-1",children:"✕"})]}):(0,a.jsx)("button",{onClick:()=>_(""),className:"w-full text-left text-xs text-gray-500 hover:text-gray-300 p-2 mb-2",children:"+ Add root section"}),U.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>{d(e.path),e.hasChildren&&F(e.path)},className:"w-full text-left p-2 rounded flex items-center gap-2 group transition-colors ".concat(o===e.path?"bg-blue-600/30 text-blue-300":"hover:bg-gray-700/50"),style:{paddingLeft:"".concat(16*e.depth+8,"px")},children:[e.hasChildren?(0,a.jsx)("span",{className:"w-4 text-gray-500",children:v.has(e.path)?"▼":"▶"}):(0,a.jsx)("span",{className:"w-4"}),(0,a.jsx)("span",{className:"text-sm",children:W[e.key]||(e.hasContent?"\uD83D\uDCC4":"\uD83D\uDCC1")}),(0,a.jsx)("span",{className:"flex-1 text-sm truncate",children:e.key.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}),e.hasContent&&(0,a.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-400",title:"Has content"}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),T(e.path)},className:"opacity-0 group-hover:opacity-100 text-red-400 hover:text-red-300 px-1",children:"\xd7"})]}),v.has(e.path)&&(S===e.path?(0,a.jsxs)("div",{className:"flex items-center gap-1 p-2 bg-gray-700 rounded my-1",style:{marginLeft:"".concat((e.depth+1)*16+8,"px")},children:[(0,a.jsx)("input",{type:"text",value:C,onChange:e=>D(e.target.value),placeholder:"Section name",className:"flex-1 bg-gray-600 border-none rounded px-2 py-1 text-sm focus:outline-none",autoFocus:!0,onKeyDown:t=>{"Enter"===t.key&&E(e.path),"Escape"===t.key&&_(null)}}),(0,a.jsx)("button",{onClick:()=>E(e.path),className:"text-green-400 hover:text-green-300 px-1",children:"✓"}),(0,a.jsx)("button",{onClick:()=>_(null),className:"text-gray-400 hover:text-white px-1",children:"✕"})]}):(0,a.jsx)("button",{onClick:()=>_(e.path),className:"text-xs text-gray-600 hover:text-gray-400 p-1",style:{marginLeft:"".concat((e.depth+1)*16+24,"px")},children:"+ Add child"}))]},e.path))]})}),(0,a.jsx)("div",{className:"flex-1 flex flex-col min-h-0",children:o&&R&&"object"==typeof R?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-700 flex-shrink-0",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)("span",{children:W[o.split(".").pop()||""]||"\uD83D\uDCC4"}),null===(t=o.split(".").pop())||void 0===t?void 0:t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 font-mono",children:o})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>k(!w),className:"px-3 py-1 rounded text-sm ".concat(w?"bg-purple-600/30 text-purple-300":"bg-gray-700 text-gray-400 hover:text-white"),children:w?"✓ Preview":"Preview"}),(0,a.jsx)("button",{onClick:()=>{if(!o)return;let e=V(i,o);if(!e||"object"!=typeof e)return;let t={...e,description:x||void 0,content:u||void 0};t.description||delete t.description,t.content||delete t.content,c(Y(i,o,t)),j(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm",children:"Apply Changes"})]})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm text-gray-400 mb-1",children:["Description",(0,a.jsx)("span",{className:"text-gray-600 ml-2",children:"(internal documentation)"})]}),(0,a.jsx)("input",{type:"text",value:x,onChange:e=>m(e.target.value),placeholder:"Brief description of this section's purpose",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500"})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,a.jsxs)("label",{className:"block text-sm text-gray-400 mb-1",children:["Content",(0,a.jsx)("span",{className:"text-gray-600 ml-2",children:"(prompt text sent to agents)"})]}),(0,a.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),placeholder:"Enter the prompt content here. Supports Markdown formatting.",className:"flex-1 min-h-[300px] w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm font-mono focus:outline-none focus:border-blue-500 resize-none"})]}),w&&u&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm text-gray-400 mb-1",children:["Preview",(0,a.jsx)("span",{className:"text-gray-600 ml-2",children:"(how it appears to agents)"})]}),(0,a.jsx)("div",{className:"bg-gray-900 border border-gray-700 rounded p-4 text-sm",children:(0,a.jsx)("pre",{className:"whitespace-pre-wrap font-mono text-gray-300",children:"## ".concat(null===(s=o.split(".").pop())||void 0===s?void 0:s.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),"\n").concat(u)})})]}),(0,a.jsxs)("div",{className:"bg-gray-700/30 rounded p-3 text-xs text-gray-500",children:[(0,a.jsx)("strong",{className:"text-gray-400",children:"Tips:"}),(0,a.jsxs)("ul",{className:"list-disc ml-4 mt-1 space-y-1",children:[(0,a.jsxs)("li",{children:["Use ",(0,a.jsx)("code",{className:"bg-gray-800 px-1 rounded",children:"##"})," for section headers in content"]}),(0,a.jsxs)("li",{children:["Use ",(0,a.jsx)("code",{className:"bg-gray-800 px-1 rounded",children:"`code`"})," for inline code formatting"]}),(0,a.jsxs)("li",{children:["Use ",(0,a.jsx)("code",{className:"bg-gray-800 px-1 rounded",children:"```json"})," blocks for JSON examples"]}),(0,a.jsx)("li",{children:"Technical sections define response formats; Philosophy sections shape agent personality"})]})]})]})]}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCDD"}),(0,a.jsx)("div",{children:"Select a section to edit"}),(0,a.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"Click any section on the left"})]})})})]})}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-700 flex justify-between items-center flex-shrink-0",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[P.length," sections • ",P.filter(e=>e.hasContent).length," with content"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[b&&(0,a.jsx)("button",{onClick:O,className:"text-gray-400 hover:text-white px-3 py-1.5 text-sm",children:"Discard Changes"}),(0,a.jsx)("button",{onClick:r,className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm transition-colors",children:"Close"})]})]})]})})}function G(){var e,t,s,r,c,d;let[h,O]=(0,n.useState)(null),[E,T]=(0,n.useState)(!0),[F,P]=(0,n.useState)(0),[U,I]=(0,n.useState)(!1),[M,H]=(0,n.useState)(!1),[L,J]=(0,n.useState)(!1),[z,K]=(0,n.useState)(!1),[W,V]=(0,n.useState)(!1),{data:Y=[],mutate:G}=(0,l.ZP)("agents",g,{refreshInterval:2e3}),{data:Q,mutate:X}=(0,l.ZP)("apiStatus",_,{refreshInterval:1e4,onError:()=>{}}),{data:ee,mutate:et}=(0,l.ZP)("heartbeatStatus",C,{refreshInterval:2e3,onError:()=>{}}),{data:es=[],mutate:ea}=(0,l.ZP)(h?"members-".concat(h.id):null,()=>h?N(h.id):[],{refreshInterval:2e3}),{data:en=[],mutate:el}=(0,l.ZP)(h?"messages-".concat(h.id):null,()=>h?b(h.id):[],{refreshInterval:1e3}),{data:er=["gpt-4o-mini","gpt-4o","gpt-4-turbo"]}=(0,l.ZP)((null==Q?void 0:Q.connected)?"models":null,A,{onError:()=>{}});(0,n.useEffect)(()=>{if(h){let e=Y.find(e=>e.id===h.id);e&&O(e)}},[Y,h]);let ei=(0,n.useCallback)(e=>{O(e),P(0)},[]),ec=(0,n.useCallback)(async()=>{try{let e=await p({name:"New Agent",model:"gpt-4o-mini",background_prompt:"You are a helpful AI assistant."});await G(),O(e)}catch(e){console.error("Failed to create agent:",e),alert("Failed to create agent")}},[G]),eo=(0,n.useCallback)(async e=>{if(confirm("Delete agent #".concat(e,"?")))try{await f(e),await G(),(null==h?void 0:h.id)===e&&O(null)}catch(e){console.error("Failed to delete agent:",e),alert("Failed to delete agent")}},[G,h]),ed=(0,n.useCallback)(async(e,t)=>{try{let s=await y(e,t);await G(),O(s)}catch(e){console.error("Failed to save agent:",e),alert("Failed to save agent")}},[G]),ex=(0,n.useCallback)(async e=>{if(h)try{await w(h.id,e),await ea()}catch(e){console.error("Failed to add member:",e),alert("Failed to add member")}},[h,ea]),em=(0,n.useCallback)(async e=>{if(h)try{await k(h.id,e),await ea()}catch(e){console.error("Failed to remove member:",e),alert("Failed to remove member")}},[h,ea]),eu=(0,n.useCallback)(async e=>{if(h)try{await j(h.id,"The Architect",e),await el()}catch(e){console.error("Failed to send message:",e),alert("Failed to send message")}},[h,el]),eh=(0,n.useCallback)(async()=>{if(h&&confirm("Clear all messages in this room?"))try{await v(h.id),await el()}catch(e){console.error("Failed to clear messages:",e),alert("Failed to clear messages")}},[h,el]),eg=(0,n.useCallback)(async()=>{try{(null==ee?void 0:ee.running)?await S():await D(),await et()}catch(e){console.error("Failed to toggle heartbeat:",e),alert(e.message||"Failed to toggle heartbeat")}},[ee,et]);return(0,a.jsxs)("main",{className:"h-screen p-4 flex flex-col",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between text-sm text-gray-400",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{children:"AI Chat Room"}),(0,a.jsx)(u,{onOpenSettings:()=>I(!0),onOpenHUDHistory:()=>H(!0),onOpenKnowledge:()=>J(!0),onOpenTelemetry:()=>K(!0),onOpenHUDEditor:()=>V(!0),apiConnected:null!==(e=null==Q?void 0:Q.connected)&&void 0!==e&&e,heartbeatRunning:null!==(t=null==ee?void 0:ee.running)&&void 0!==t&&t})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:(null==Q?void 0:Q.connected)?"text-green-400":"text-red-400",children:["● API: ",(null==Q?void 0:Q.connected)?"Connected":"Disconnected"]}),(0,a.jsxs)("span",{className:(null==ee?void 0:ee.running)?"text-green-400":"text-gray-500",children:["● Heartbeat: ",(null==ee?void 0:ee.running)?"Running":"Stopped"]})]})]}),(0,a.jsxs)("div",{className:"flex-1 flex gap-4 min-h-0",children:[(0,a.jsxs)("div",{className:"w-80 flex flex-col gap-4 min-h-0",children:[(0,a.jsx)("div",{className:"flex-1 min-h-0",children:(0,a.jsx)(i,{agents:Y,selectedId:null!==(s=null==h?void 0:h.id)&&void 0!==s?s:null,onSelect:ei,onCreate:ec,onDelete:eo})}),(0,a.jsx)("div",{className:"h-48 flex-shrink-0",children:(0,a.jsx)(x,{roomId:null!==(r=null==h?void 0:h.id)&&void 0!==r?r:null,members:es,availableAgents:Y,onAddMember:ex,onRemoveMember:em})})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col gap-4 min-h-0",children:[(0,a.jsx)("div",{className:E?"flex-1 min-h-0":"flex-shrink-0",children:(0,a.jsx)(o,{agent:h,models:er,onSave:ed,expanded:E,onToggle:()=>T(!E)})}),(0,a.jsx)("div",{className:"flex-1 min-h-0",children:(0,a.jsx)(m,{roomId:null!==(c=null==h?void 0:h.id)&&void 0!==c?c:null,messages:en,agents:Y,heartbeatRunning:null!==(d=null==ee?void 0:ee.running)&&void 0!==d&&d,onSendMessage:eu,onClearMessages:eh,onToggleHeartbeat:eg})})]})]}),(0,a.jsx)(R,{isOpen:U,onClose:()=>I(!1),apiStatus:Q,onApiKeySet:()=>X()}),(0,a.jsx)($,{isOpen:M,onClose:()=>H(!1),agent:h}),(0,a.jsx)(B,{isOpen:L,onClose:()=>J(!1),agent:h}),(0,a.jsx)(Z,{isOpen:z,onClose:()=>K(!1)}),(0,a.jsx)(q,{isOpen:W,onClose:()=>V(!1)})]})}}},function(e){e.O(0,[86,971,117,744],function(){return e(e.s=3897)}),_N_E=e.O()}]);